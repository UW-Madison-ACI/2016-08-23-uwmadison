---
layout: setup
root: ./
assistant: []
contact: admin@datacarpentry.org
---
<!--
    Edit the values in the parameter block above to be appropriate for your bootcamp.
    Please use three-letter month names for the 'humandate' field.
-->


<h2>SQL</h2>

<p>We will be using the Data Carpentry SQL lesson, adapted for this workshop.  </p>

<ul>
<li><a href="http://www.datacarpentry.org/sql-ecology-lesson/">Lesson material</a></li>
<li><a href="queries.txt">Reference list of queries</a></li>
<li><a href="#exercises">Activities and exercises</a></li>
</ul>

<a name="exercises"></a>
<h2> SQL Activities and Exercises </h2>

<h3> Getting started</h3>

<p>Download the three cleaned `.csv` files and open them in Excel (or similar).  Take 
a look.  What kind of data is there?  How do you think it was collected?  </p>

<ul>
<li> What information can I learn about the the genus Dipodomys in the 2000s, looking 
at information by year?  </li>
<li> What is the average weight of each species, per year?  </li>
</ul>

What kind of challenges will we face in order to answer these questions? 

<h3>Importing CSV Files</h3>

Import the species and surveys tables

<ol>
<li>Start the import</li>
<li> Select the file to import</li>
<li> Give the table a name that matches the file name (surveys, species, plots), or use the default</li>
<li> If the first row has column headings, check the appropriate box</li>
<li>Make sure the delimiter and quotation options are appropriate for the CSV files.  Ensure 'Ignore trailing Separator/Delimiter' is left *unchecked*.</li>
<li>Press **OK**</li>
<li> When asked if you want to modify the table, click **OK**</li>
<li>Set the data types for each field: choose TEXT for fields with text
   (species_id, genus, sex, etc.) and INT for fields with numbers (day,
   month, year, weight, etc.) </li>
   </ol>

<h3>Using WHERE</h3>

Write a query that returns the day, month, year, species_id, and weight (in kg) 
for individuals caught on Plot 1 that weigh more than 75 g

<h3>More Complex Queries</h3>

Let’s try to combine what we’ve learned so far in a single query. 
Using the surveys table write a query to display the three date fields, 
species_id, and weight in kilograms (rounded to two decimal places), for 
individuals captured in 1999, ordered alphabetically by the species_id. Write 
the query as a single line, then put each clause on its own line, and see 
how more legible the query becomes!

<h3>Using GROUP BY and HAVING</h3>

How many individuals were counted in each year: 

a) in total

b) per each species

c) restrict your query from (b) to the cases where the count of a species in a year 
was greater than 500.  

<h3>Using `GROUP BY`, part II </h3>

<ul>
<li> What is the average weight of each species, per year?  </li>
<li> What information can I learn about the the genus Dipodomys in the 2000s, looking 
at information by year?  </li>
</ul>

<h3>Aggregation and JOINs</h3>

Write a query that returns the number of genus of the animals caught 
in each plot in descending order.

<h3>Final Exercises</h3>

Have a look at the following questions; these questions are written in plain English. Can you translate them to *SQL queries* and give a suitable answer?
<ol>
<li>How many plots from each type are there?  </li>
<li>How many specimens are of each gender are there for each year?  </li>
<li>How many specimens of each species were captured in each type of plot?</li>  
<li>What is the average weight of each taxa?  </li>
<li>What is the percentage of each species in each taxa?  </li>
<li>What are the minimum, maximum and average weight for each species of Rodent?  </li>
<li>What is the hindfoot length for male and female rodent of each species? Is there a Male / Female difference?  </li>
<li>What is the average weight of each rodent species over the course of the years? Is there any noticeable trend for any of the species?  </li>
</ol>